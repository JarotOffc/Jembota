<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Login/Register Tester</title>

  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- React + ReactDOM CDN -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

  <!-- React Router DOM CDN -->
  <script crossorigin src="https://unpkg.com/react-router-dom@6/umd/react-router-dom.development.js"></script>

  <!-- Supabase CDN -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.35.0/dist/supabase.min.js"></script>
</head>
<body class="bg-gray-100">
<div id="root"></div>

<script type="text/javascript">
  const { useState, useEffect } = React;
  const { BrowserRouter, Routes, Route, Link, useNavigate } = ReactRouterDOM;

  // --- Supabase Client ---
  const SUPABASE_URL = "YOUR_SUPABASE_URL";        // Ganti dengan milikmu
  const SUPABASE_ANON_KEY = "YOUR_SUPABASE_ANON_KEY"; // Ganti dengan milikmu
  const supabase = supabaseJs.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

  // --- Login Component ---
  function Login({ setUser }) {
    const [email, setEmail] = useState("");
    const [password, setPassword] = useState("");
    const navigate = useNavigate();

    const handleLogin = async (e) => {
      e.preventDefault();
      const { data, error } = await supabase.auth.signInWithPassword({ email, password });
      if (error) alert(error.message);
      else {
        setUser(data.user);
        alert("Login berhasil!");
        navigate("/");
      }
    };

    return (
      <div className="max-w-md mx-auto bg-white p-6 rounded-lg shadow mt-10">
        <h2 className="text-xl font-semibold mb-4">Login</h2>
        <form onSubmit={handleLogin} className="space-y-4">
          <input type="email" placeholder="Email" value={email} onChange={e=>setEmail(e.target.value)} className="w-full p-2 border rounded" required/>
          <input type="password" placeholder="Password" value={password} onChange={e=>setPassword(e.target.value)} className="w-full p-2 border rounded" required/>
          <button type="submit" className="w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700">Login</button>
        </form>
        <p className="mt-4 text-sm">Belum punya akun? <Link to="/register" className="text-blue-600 underline">Register</Link></p>
      </div>
    );
  }

  // --- Register Component ---
  function Register() {
    const [email, setEmail] = useState("");
    const [password, setPassword] = useState("");
    const navigate = useNavigate();

    const handleRegister = async (e) => {
      e.preventDefault();
      const { user, error } = await supabase.auth.signUp({ email, password });
      if (error) alert(error.message);
      else {
        alert("Registrasi sukses! Cek email untuk verifikasi.");
        navigate("/login");
      }
    };

    return (
      <div className="max-w-md mx-auto bg-white p-6 rounded-lg shadow mt-10">
        <h2 className="text-xl font-semibold mb-4">Register</h2>
        <form onSubmit={handleRegister} className="space-y-4">
          <input type="email" placeholder="Email" value={email} onChange={e=>setEmail(e.target.value)} className="w-full p-2 border rounded" required/>
          <input type="password" placeholder="Password" value={password} onChange={e=>setPassword(e.target.value)} className="w-full p-2 border rounded" required/>
          <button type="submit" className="w-full bg-green-600 text-white py-2 rounded hover:bg-green-700">Register</button>
        </form>
        <p className="mt-4 text-sm">Sudah punya akun? <Link to="/login" className="text-blue-600 underline">Login</Link></p>
      </div>
    );
  }

  // --- App Component ---
  function App() {
    const [user, setUser] = useState(null);

    useEffect(() => {
      supabase.auth.getSession().then(({ data }) => setUser(data.session?.user || null));
      supabase.auth.onAuthStateChange((_event, session) => setUser(session?.user || null));
    }, []);

    const handleLogout = async () => {
      await supabase.auth.signOut();
      setUser(null);
      alert("Logout berhasil!");
    };

    return (
      <BrowserRouter>
        <header className="bg-gray-900 text-white p-4 flex justify-between">
          <h1 className="font-bold text-xl">Supabase Login Tester</h1>
          {user && <button onClick={handleLogout} className="bg-red-600 px-3 py-1 rounded hover:bg-red-700">Logout</button>}
        </header>
        <Routes>
          <Route path="/login" element={<Login setUser={setUser} />} />
          <Route path="/register" element={<Register />} />
          <Route path="/" element={<div className="p-10 text-center">{user ? `Selamat datang, ${user.email}` : 'Silakan login atau register'}</div>} />
        </Routes>
      </BrowserRouter>
    );
  }

  // --- Render App ---
  ReactDOM.createRoot(document.getElementById("root")).render(React.createElement(App));
</script>
</body>
</html>
